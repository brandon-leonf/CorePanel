# Transport security
# COREPANEL_DEBUG=0
# COREPANEL_ERROR_LOG=/absolute/path/to/php-error.log
# COREPANEL_CSP_REPORT_ENABLED=0
COREPANEL_ENFORCE_HTTPS=1
# Trust X-Forwarded-Proto/Forwarded only from your reverse proxy IP/CIDR list
# COREPANEL_TRUST_PROXY_HEADERS=1
# COREPANEL_TRUSTED_PROXIES=127.0.0.1/32,10.0.0.0/8
# For local non-TLS development only:
# COREPANEL_ALLOW_INSECURE_LOCALHOST=1
COREPANEL_HSTS_ENABLED=0
COREPANEL_HSTS_MAX_AGE=31536000
COREPANEL_HSTS_INCLUDE_SUBDOMAINS=1
COREPANEL_HSTS_PRELOAD=0

# Field encryption key management (preferred: versioned keyring)
# COREPANEL_FIELD_KEYS=k2026q1=<64-hex-or-base64-or-raw>,k2025q3=<64-hex-or-base64-or-raw>
# COREPANEL_FIELD_KEY_ACTIVE_ID=k2026q1
#
# Single-key fallback (legacy mode)
# COREPANEL_FIELD_KEY=<64-hex-characters>
# COREPANEL_FIELD_KEY=base64:<base64-encoded-key-material>
# COREPANEL_FIELD_KEY=<long-random-string-32-plus-chars>

# Monitoring and tamper-evident security logging
# COREPANEL_LOG_CHAIN_KEY=<long-random-secret>
# COREPANEL_SECURITY_LOG_FILE=/absolute/path/to/security.log
# COREPANEL_DOWNLOAD_SPIKE_WINDOW_SECONDS=600
# COREPANEL_DOWNLOAD_SPIKE_THRESHOLD=25
# COREPANEL_ADMIN_HOURS_START=6
# COREPANEL_ADMIN_HOURS_END=22
# COREPANEL_ADMIN_BURST_WINDOW_SECONDS=600
# COREPANEL_ADMIN_BURST_THRESHOLD=20
# COREPANEL_ADMIN_NEW_IP_LOOKBACK_DAYS=30

# Protected health endpoints (/health and /health/db)
# COREPANEL_HEALTH_TOKEN=<long-random-health-token>
# COREPANEL_HEALTH_DISK_PATH=/absolute/path/to/check
# COREPANEL_HEALTH_MIN_DISK_FREE_MB=512
# Queue check modes: none | db | filesystem
# COREPANEL_HEALTH_QUEUE_MODE=none
# COREPANEL_HEALTH_QUEUE_TABLE=job_queue
# COREPANEL_HEALTH_QUEUE_DIR=/absolute/path/to/queue-dir
# COREPANEL_HEALTH_QUEUE_HEARTBEAT_FILE=worker.heartbeat
# COREPANEL_HEALTH_QUEUE_HEARTBEAT_MAX_AGE_SECONDS=600

# Adaptive CAPTCHA (only after suspicious behavior)
# COREPANEL_ADAPTIVE_CAPTCHA_ENABLED=1
# COREPANEL_CAPTCHA_LOGIN_THRESHOLD=4
# COREPANEL_CAPTCHA_FORGOT_THRESHOLD=4
# COREPANEL_CAPTCHA_RESET_THRESHOLD=3
# COREPANEL_CAPTCHA_TTL_SECONDS=600

# Backup encryption and storage
# COREPANEL_BACKUP_PASSPHRASE=<long-random-backup-passphrase>
# COREPANEL_BACKUP_DIR=/absolute/path/to/encrypted-backups
# COREPANEL_BACKUP_DB_HOST=127.0.0.1
# COREPANEL_BACKUP_DB_PORT=3306
# COREPANEL_BACKUP_DB_USER=corepanel_backup
# COREPANEL_BACKUP_DB_PASSWORD_ENV=COREPANEL_BACKUP_DB_PASSWORD
# COREPANEL_BACKUP_RETENTION_DAYS=14
# COREPANEL_BACKUP_LOG_FILE=/absolute/path/to/backup_maintenance.log
# COREPANEL_BACKUP_ENV_FILE=/absolute/path/to/security.env
# COREPANEL_UPLOADS_BACKUP_SOURCE_DIR=/absolute/path/to/COREPANEL/storage/uploads
# COREPANEL_UPLOADS_BACKUP_LABEL=uploads
# Offsite replication mode: none | rclone | aws-s3 | rsync
# COREPANEL_BACKUP_OFFSITE_MODE=none
# COREPANEL_BACKUP_OFFSITE_RCLONE_REMOTE=remote:bucket/corepanel-backups
# COREPANEL_BACKUP_OFFSITE_S3_URI=s3://my-secure-bucket/corepanel-backups
# COREPANEL_BACKUP_OFFSITE_S3_STORAGE_CLASS=STANDARD_IA
# COREPANEL_BACKUP_OFFSITE_RSYNC_DEST=backup-user@backup-host:/srv/offsite/corepanel-backups
# COREPANEL_BACKUP_OFFSITE_RSYNC_RSH=ssh -i /absolute/path/to/offsite-key
# COREPANEL_RESTORE_DB_HOST=127.0.0.1
# COREPANEL_RESTORE_DB_PORT=3306
# COREPANEL_RESTORE_DB_USER=corepanel_migrator
# COREPANEL_RESTORE_DB_PASSWORD_ENV=COREPANEL_RESTORE_DB_PASSWORD
